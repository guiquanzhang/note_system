# 测试个人信息接口

## 步骤 1: 重启后端

1. 在 IDEA 中停止后端服务
2. 点击运行按钮重新启动 `CloudNoteApplication`
3. 等待控制台显示 "Started CloudNoteApplication"

---

## 步骤 2: 测试接口（使用 Postman）

### 2.1 先登录获取 Token

**请求**:
```
POST http://localhost:8080/api/user/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "123456"
}
```

**响应**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userId": 1,
    "username": "testuser",
    "email": "test@example.com"
  }
}
```

**复制 Token 值**（后面要用）

---

### 2.2 测试获取用户信息

**请求**:
```
GET http://localhost:8080/api/user/info
Authorization: Bearer YOUR_TOKEN_HERE
```

**预期响应**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "userId": 1,
    "username": "testuser",
    "email": "test@example.com",
    "createdAt": "2024-12-14T10:00:00",
    "updatedAt": "2024-12-14T10:00:00"
  }
}
```

---

### 2.3 测试更新用户信息

**请求**:
```
PUT http://localhost:8080/api/user/info
Authorization: Bearer YOUR_TOKEN_HERE
Content-Type: application/json

{
  "username": "testuser2",
  "email": "test2@example.com"
}
```

**预期响应**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": null
}
```

---

### 2.4 测试修改密码

**请求**:
```
PUT http://localhost:8080/api/user/password
Authorization: Bearer YOUR_TOKEN_HERE
Content-Type: application/json

{
  "oldPassword": "123456",
  "newPassword": "654321",
  "confirmPassword": "654321"
}
```

**预期响应**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": null
}
```

---

## 步骤 3: 前端测试

### 3.1 清除浏览器缓存
```javascript
// 在浏览器控制台执行
localStorage.clear()
```

### 3.2 重新登录
1. 访问 `http://localhost:5173/login`
2. 输入用户名和密码
3. 登录成功

### 3.3 访问个人信息页面
1. 点击右上角用户头像
2. 选择"个人信息"
3. 应该能看到用户信息

---

## 常见问题

### Q1: 404 错误
**原因**: 后端没有重新编译
**解决**: 重启后端服务

### Q2: 401 错误
**原因**: Token 无效或过期
**解决**: 重新登录获取新 Token

### Q3: 500 错误
**原因**: 后端代码有问题
**解决**: 查看后端控制台错误信息

---

## 如果还是 404

请检查后端控制台是否有以下日志：

```
Mapped "{[/user/info],methods=[GET]}" onto ...
Mapped "{[/user/info],methods=[PUT]}" onto ...
Mapped "{[/user/password],methods=[PUT]}" onto ...
```

如果没有这些日志，说明接口没有注册成功，需要：
1. 检查 UserController 是否有 @RestController 注解
2. 检查方法是否有 @GetMapping/@PutMapping 注解
3. 重新编译项目（Maven → Reload Project）
