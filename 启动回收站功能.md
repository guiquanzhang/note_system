# 🚀 启动回收站功能指南

## ✅ 功能已实现

回收站功能的所有代码已经完成：
- ✅ 后端：4 个新 API 接口
- ✅ 前端：回收站页面
- ✅ 路由：已配置
- ✅ 菜单：已添加

---

## 🔧 启动步骤

### 第 1 步：重启后端服务

#### 方法 1：使用 IDEA
```
1. 在 IDEA 中停止当前运行的 CloudNoteApplication
2. 点击绿色运行按钮重新启动
3. 等待控制台显示 "Started CloudNoteApplication"
```

#### 方法 2：使用 Maven（如果配置了）
```bash
# 在项目根目录执行
mvn clean package
java -jar target/cloudnote-0.0.1-SNAPSHOT.jar
```

---

### 第 2 步：重启前端服务

#### 如果前端正在运行
```
前端会自动热更新，无需重启
```

#### 如果前端未运行
```bash
cd front_end
npm run dev
```

---

### 第 3 步：验证功能

#### 1. 检查后端接口
访问后端控制台，应该看到新的接口映射：
```
Mapped "{[/note/trash],methods=[GET]}" onto ...
Mapped "{[/note/{noteId}/restore],methods=[PUT]}" onto ...
Mapped "{[/note/{noteId}/permanent],methods=[DELETE]}" onto ...
Mapped "{[/note/trash/empty],methods=[DELETE]}" onto ...
```

#### 2. 检查前端菜单
```
1. 访问 http://localhost:5173
2. 登录系统
3. 查看左侧边栏
4. 应该能看到"回收站"菜单项
```

---

## 🧪 快速测试

### 测试 1：访问回收站
```
1. 登录系统
2. 点击左侧边栏的"回收站"
3. 应该能看到回收站页面
4. 如果没有删除的笔记，会显示"回收站为空"
```

### 测试 2：删除笔记到回收站
```
1. 在笔记列表中选择一条笔记
2. 点击"删除"按钮
3. 确认删除
4. 访问回收站
5. 应该能看到刚才删除的笔记
```

### 测试 3：恢复笔记
```
1. 在回收站中找到一条笔记
2. 点击"恢复"按钮
3. 确认恢复
4. 返回笔记列表
5. 笔记应该重新出现
```

### 测试 4：永久删除
```
1. 在回收站中找到一条笔记
2. 点击"永久删除"按钮
3. 确认删除
4. 笔记从回收站消失
```

---

## 🐛 常见问题

### 问题 1：后端 404 错误
**原因**：后端没有重新编译
**解决**：
```
1. 在 IDEA 中停止后端
2. 点击 Build → Rebuild Project
3. 重新运行 CloudNoteApplication
```

### 问题 2：前端找不到回收站菜单
**原因**：前端代码未更新
**解决**：
```
1. 刷新浏览器（Ctrl + F5 强制刷新）
2. 清除浏览器缓存
3. 重启前端服务
```

### 问题 3：点击回收站菜单没反应
**原因**：路由配置问题
**解决**：
```
1. 打开浏览器控制台（F12）
2. 查看是否有错误信息
3. 确认 front_end/src/router/index.js 已更新
4. 确认 front_end/src/views/note/Trash.vue 文件存在
```

### 问题 4：回收站页面报错
**原因**：缺少依赖或组件
**解决**：
```
1. 检查浏览器控制台错误信息
2. 确认所有图标已导入
3. 确认 API 接口已添加
```

---

## 📁 新增文件清单

### 后端文件（已修改）
```
✅ src/main/java/com/cloudnote/service/NoteService.java
✅ src/main/java/com/cloudnote/service/impl/NoteServiceImpl.java
✅ src/main/java/com/cloudnote/controller/NoteController.java
```

### 前端文件
```
✅ front_end/src/api/note.js（已修改）
✅ front_end/src/views/note/Trash.vue（新建）
✅ front_end/src/router/index.js（已修改）
✅ front_end/src/layout/MainLayout.vue（已修改）
```

### 文档文件
```
✅ 回收站功能说明.md（新建）
✅ 功能完成总结.md（新建）
✅ 启动回收站功能.md（本文档）
```

---

## 🎯 新增 API 接口

### 1. 获取回收站列表
```
GET /api/note/trash?pageNum=1&pageSize=10
```

### 2. 恢复笔记
```
PUT /api/note/{noteId}/restore
```

### 3. 永久删除笔记
```
DELETE /api/note/{noteId}/permanent
```

### 4. 清空回收站
```
DELETE /api/note/trash/empty
```

---

## ✨ 功能特性

### 1. 软删除机制
- 删除笔记时不会立即从数据库删除
- 标记为已删除状态（deleted = 1）
- 记录删除时间（deleted_at）

### 2. 回收站列表
- 显示所有已删除的笔记
- 按删除时间倒序排列
- 支持分页查看

### 3. 恢复功能
- 一键恢复已删除的笔记
- 恢复后笔记回到正常列表

### 4. 永久删除
- 从数据库中彻底删除笔记
- 删除后无法恢复
- 需要二次确认

### 5. 清空回收站
- 一键清空所有已删除笔记
- 批量永久删除
- 需要二次确认

---

## 📚 相关文档

- `回收站功能说明.md` - 详细功能说明和测试步骤
- `功能完成总结.md` - 项目完整功能总结
- `API接口文档.md` - API 接口文档

---

## 🎉 总结

回收站功能已完整实现，只需：
1. ✅ 重启后端服务（IDEA 中重新运行）
2. ✅ 前端自动更新（或刷新浏览器）
3. ✅ 开始测试

**祝测试顺利！** 🚀

---

**文档版本**: v1.0.0  
**创建日期**: 2024-12-20  
**作者**: 云笔记开发团队
