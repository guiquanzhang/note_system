# 云笔记功能优化规划

## 一、批量删除功能

### 前端实现
1. **笔记列表页面**
   - 添加"批量管理"按钮
   - 进入批量模式后，每个笔记卡片显示复选框
   - 顶部显示已选择数量
   - 显示"删除选中"、"取消"按钮

2. **删除确认**
   - 使用 ElMessageBox 确认对话框
   - 显示将要删除的笔记数量
   - 提示：删除后可在回收站恢复

### 后端API需求
```
PUT /api/notes/batch-delete
Body: { noteIds: [1, 2, 3] }
功能：批量将笔记移到回收站（软删除）
```

## 二、回收站功能

### 数据库设计
在 `note` 表添加字段：
- `deleted` TINYINT DEFAULT 0 (0=正常, 1=已删除)
- `deleted_at` TIMESTAMP NULL (删除时间)

### 前端实现
1. **侧边栏添加"回收站"菜单项**
2. **回收站页面** (`/trash`)
   - 显示已删除的笔记列表
   - 每个笔记显示删除时间
   - 操作按钮：恢复、彻底删除
   - 顶部操作：清空回收站

3. **自动清理**
   - 显示提示：回收站笔记保留30天
   - 超过30天自动彻底删除

### 后端API需求
```
GET /api/notes/trash
功能：获取回收站笔记列表

PUT /api/notes/{id}/restore
功能：恢复笔记

DELETE /api/notes/{id}/permanent
功能：彻底删除笔记

DELETE /api/notes/trash/clear
功能：清空回收站
```

## 三、首页信息优化

### 概览卡片
1. **统计信息**
   - 笔记总数
   - 分类数量
   - 今日新增
   - 本周编辑

2. **最近动态**
   - 最近编辑的5篇笔记
   - 最近创建的5篇笔记
   - 显示时间和标题

3. **快速操作**
   - 新建笔记
   - 查看全部笔记
   - 分类管理

### 后端API需求
```
GET /api/dashboard/stats
返回：{
  totalNotes: 100,
  totalCategories: 10,
  todayNotes: 5,
  weekNotes: 20
}

GET /api/dashboard/recent
返回：{
  recentEdited: [...],
  recentCreated: [...]
}
```

## 四、搜索增强

### 功能实现
1. **搜索历史**
   - 保存最近10条搜索记录
   - 存储在 localStorage
   - 点击历史记录快速搜索
   - 可清除单条或全部历史

2. **关键词高亮**
   - 搜索结果中高亮显示关键词
   - 标题和内容都高亮

3. **搜索建议**
   - 输入时显示历史搜索
   - 显示热门搜索（可选）

### 前端实现
- 使用 localStorage 存储搜索历史
- 使用正则表达式高亮关键词
- 搜索框下拉显示历史记录

## 实现优先级

### P0（立即实现）
1. ✅ 护眼蓝主题
2. 批量删除功能
3. 回收站基础功能

### P1（本周完成）
4. 首页概览信息
5. 搜索历史
6. 关键词高亮

### P2（后续优化）
7. 自动清理回收站
8. 搜索建议
9. 更多统计图表

## 技术要点

### 批量操作
- 使用 Set 存储选中的笔记ID
- 使用 v-model 绑定复选框状态
- 批量API调用使用 Promise.all

### 软删除
- 不直接删除数据库记录
- 使用 deleted 字段标记
- 查询时过滤 deleted=1 的记录

### 搜索优化
- 防抖处理（300ms）
- 高亮使用 v-html（注意XSS防护）
- 历史记录限制数量

## 用户体验

### 删除流程
1. 用户点击删除 → 确认对话框
2. 提示："笔记将移到回收站，可在30天内恢复"
3. 删除成功 → 提示："已移到回收站"
4. 提供"撤销"按钮（3秒内）

### 回收站流程
1. 进入回收站 → 看到已删除笔记
2. 点击恢复 → 确认对话框 → 恢复成功
3. 点击彻底删除 → 二次确认 → 永久删除
4. 清空回收站 → 严重警告 → 输入确认文字 → 清空

### 搜索体验
1. 输入关键词 → 显示历史记录
2. 按回车搜索 → 结果高亮显示
3. 点击历史记录 → 快速搜索
4. 清除按钮 → 清空搜索和历史
