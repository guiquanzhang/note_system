import{y as v,L as B,N as H,K as _,c as h,o as g,a as o,b as t,w as a,f as m,U as J,r as n,u as O,d as f,S as P,t as b,g as Q,k as X,F as Y,e as Z,n as ee,ae as te,s as M,T as ae,W as le}from"./index-CxuP8R5R.js";import{g as oe,d as se,c as ne}from"./tag-ChL4S8wq.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-CqNpOxbT.js";const de={class:"tag-list-page"},ce={class:"page-header fade-in-up"},re={class:"tag-stats fade-in-up-delay-1"},ue={class:"stat-item"},me={class:"stat-info"},_e={class:"stat-value"},fe={class:"stat-item"},pe={class:"stat-info"},ve={class:"stat-value"},ge={class:"tag-cloud-section fade-in-up-delay-2"},ye={class:"card-header"},he={key:0,class:"tag-cloud"},be=["onClick"],xe={class:"tag-list-section fade-in-up-delay-3"},we={class:"card-header"},ke={__name:"List",setup(Ce){const U=O(),c=v([]),y=v(""),p=v(!1),C=v("新建标签"),d=v({name:"",color:""}),N=B(()=>c.value.reduce((s,e)=>s+e.count,0)),D=B(()=>y.value?c.value.filter(s=>s.name.toLowerCase().includes(y.value.toLowerCase())):c.value);H(async()=>{await x()});const x=async()=>{try{c.value=await oe()}catch{_.error("加载标签失败")}},E=()=>{C.value="新建标签",d.value={name:"",color:T("")},p.value=!0},F=async()=>{if(!d.value.name.trim()){_.warning("请输入标签名称");return}try{await ne({name:d.value.name.trim(),color:d.value.color}),_.success("创建成功"),p.value=!1,await x()}catch(s){_.error(s.message||"创建失败")}},I=s=>{le.confirm(`确定要删除标签"${s.name}"吗？这将从所有笔记中移除该标签。`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await se(s.tagId),_.success("删除成功"),await x()}catch{_.error("删除失败")}}).catch(()=>{})},V=s=>{U.push(`/notes?tag=${encodeURIComponent(s)}`)},R=s=>{const e=Math.max(...c.value.map(w=>w.count),1),i=14,u=i+s/e*(32-i);return{fontSize:`${u}px`,padding:`${u/4}px ${u/2}px`}},T=s=>{const e=["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#fa709a","#fee140","#30cfd0","#330867"];if(!s)return e[Math.floor(Math.random()*e.length)];let i=0;for(let r=0;r<s.length;r++)i=s.charCodeAt(r)+((i<<5)-i);return e[Math.abs(i)%e.length]};return(s,e)=>{const i=n("el-button"),r=n("el-icon"),u=n("el-card"),w=n("el-tooltip"),z=n("el-badge"),A=n("el-empty"),L=n("el-input"),K=n("el-tag"),k=n("el-table-column"),q=n("el-table"),S=n("el-form-item"),W=n("el-color-picker"),j=n("el-form"),G=n("el-dialog");return g(),h("div",de,[o("div",ce,[e[6]||(e[6]=o("h2",null,"标签管理",-1)),t(i,{type:"primary",icon:m(J),onClick:E,class:"hover-lift active-scale"},{default:a(()=>[...e[5]||(e[5]=[f(" 新建标签 ",-1)])]),_:1},8,["icon"])]),o("div",re,[t(u,{class:"glass-card stat-card"},{default:a(()=>[o("div",ue,[t(r,{size:32,color:"#667eea"},{default:a(()=>[t(m(P))]),_:1}),o("div",me,[o("div",_e,b(c.value.length),1),e[7]||(e[7]=o("div",{class:"stat-label"},"标签总数",-1))])])]),_:1}),t(u,{class:"glass-card stat-card"},{default:a(()=>[o("div",fe,[t(r,{size:32,color:"#f5576c"},{default:a(()=>[t(m(Q))]),_:1}),o("div",pe,[o("div",ve,b(N.value),1),e[8]||(e[8]=o("div",{class:"stat-label"},"笔记总数",-1))])])]),_:1})]),o("div",ge,[t(u,{class:"glass-card"},{header:a(()=>[o("div",ye,[e[9]||(e[9]=o("span",null,"标签云",-1)),t(w,{content:"标签大小表示使用频率"},{default:a(()=>[t(r,null,{default:a(()=>[t(m(te))]),_:1})]),_:1})])]),default:a(()=>[c.value.length>0?(g(),h("div",he,[(g(!0),h(Y,null,Z(c.value,l=>(g(),h("div",{key:l.name,class:"tag-item hover-lift active-scale",style:ee(R(l.count)),onClick:$=>V(l.name)},[o("span",null,b(l.name),1),t(z,{value:l.count,class:"tag-badge"},null,8,["value"])],12,be))),128))])):(g(),X(A,{key:1,description:"还没有标签"}))]),_:1})]),o("div",xe,[t(u,{class:"glass-card"},{header:a(()=>[o("div",we,[e[10]||(e[10]=o("span",null,"标签列表",-1)),t(L,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),placeholder:"搜索标签...","prefix-icon":m(M),clearable:"",style:{width:"300px"}},null,8,["modelValue","prefix-icon"])])]),default:a(()=>[t(q,{data:D.value,stripe:"",class:"tag-table"},{default:a(()=>[t(k,{prop:"name",label:"标签名称","min-width":"200"},{default:a(({row:l})=>[t(K,{color:T(l.name),effect:"light",size:"large"},{default:a(()=>[f(b(l.name),1)]),_:2},1032,["color"])]),_:1}),t(k,{prop:"count",label:"使用次数",width:"150",sortable:""},{default:a(({row:l})=>[t(z,{value:l.count,max:999},null,8,["value"])]),_:1}),t(k,{label:"操作",width:"200",fixed:"right"},{default:a(({row:l})=>[t(i,{type:"primary",size:"small",icon:m(M),onClick:$=>V(l.name),class:"active-scale"},{default:a(()=>[...e[11]||(e[11]=[f(" 查看笔记 ",-1)])]),_:1},8,["icon","onClick"]),t(i,{type:"danger",size:"small",icon:m(ae),onClick:$=>I(l),class:"active-scale"},{default:a(()=>[...e[12]||(e[12]=[f(" 删除 ",-1)])]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),t(G,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=l=>p.value=l),title:C.value,width:"500px",class:"glass-modal"},{footer:a(()=>[t(i,{onClick:e[3]||(e[3]=l=>p.value=!1),class:"active-scale"},{default:a(()=>[...e[14]||(e[14]=[f("取消",-1)])]),_:1}),t(i,{type:"primary",onClick:F,class:"active-scale"},{default:a(()=>[...e[15]||(e[15]=[f("确定",-1)])]),_:1})]),default:a(()=>[t(j,{model:d.value,"label-width":"80px"},{default:a(()=>[t(S,{label:"标签名称"},{default:a(()=>[t(L,{modelValue:d.value.name,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value.name=l),placeholder:"请输入标签名称",maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(S,{label:"标签颜色"},{default:a(()=>[t(W,{modelValue:d.value.color,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value.color=l),"show-alpha":""},null,8,["modelValue"]),e[13]||(e[13]=o("span",{style:{"margin-left":"12px",color:"#909399"}},"选择标签颜色（可选）",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Se=ie(ke,[["__scopeId","data-v-119f2ad8"]]);export{Se as default};
