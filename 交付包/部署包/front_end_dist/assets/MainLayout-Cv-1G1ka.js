import{y as $,C as N,z as H,k as j,o as g,w as t,b as e,r as s,d as _,f as a,D as J,E as K,G as O,H as Q,I as W,J as q,a as i,K as h,L as X,M as Y,N as Z,c as V,u as ee,O as te,t as A,P as le,i as oe,Q as ae,R as se,g as ne,j as P,S as ue,s as de,T as ie,U as re,F as me,e as ce,V as _e,l as pe,W as R}from"./index-CxuP8R5R.js";import{_ as fe}from"./logo-Ft4BtHHg.js";import"./index-DbT8dq-d.js";import{g as ge}from"./avatar-CoqCFoW7.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as ve}from"./user-DY1xn_IR.js";import{u as Se}from"./category-CzVHQ6Cc.js";import"./request-CqNpOxbT.js";const ye={__name:"SettingsDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(E,{emit:y}){const x=E,b=y,c=$(x.modelValue);N(()=>x.modelValue,n=>{c.value=n}),N(c,n=>{b("update:modelValue",n)});const u=H({theme:localStorage.getItem("theme")||"light",listLayout:localStorage.getItem("listLayout")||"grid",pageSize:parseInt(localStorage.getItem("pageSize")||"20"),autoSave:localStorage.getItem("autoSave")==="true",editorFontSize:parseInt(localStorage.getItem("editorFontSize")||"14")}),w=n=>{localStorage.setItem("theme",n),k(n),h.success("主题已切换")},k=n=>{let l=n;n==="auto"&&(l=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");const d=document.documentElement;d.classList.remove("dark","blue"),l==="dark"?(d.classList.add("dark"),d.style.colorScheme="dark"):l==="blue"?(d.classList.add("blue"),d.style.colorScheme="dark"):d.style.colorScheme="light"},L=n=>{localStorage.setItem("listLayout",n),h.success("布局已切换，刷新页面后生效")},B=n=>{localStorage.setItem("pageSize",n.toString()),h.success("设置已保存，刷新页面后生效")},F=n=>{localStorage.setItem("autoSave",n.toString()),h.success(n?"已开启自动保存":"已关闭自动保存")},M=n=>{localStorage.setItem("editorFontSize",n.toString()),h.success("字体大小已设置，刷新页面后生效")},p=()=>{u.theme="light",u.listLayout="grid",u.pageSize=20,u.autoSave=!1,u.editorFontSize=14,localStorage.setItem("theme","light"),localStorage.setItem("listLayout","grid"),localStorage.setItem("pageSize","20"),localStorage.setItem("autoSave","false"),localStorage.setItem("editorFontSize","14"),k("light"),h.success("已恢复默认设置，刷新页面后完全生效")},o=()=>{c.value=!1};return(n,l)=>{const d=s("el-icon"),f=s("el-radio-button"),C=s("el-radio-group"),v=s("el-form-item"),r=s("el-option"),I=s("el-select"),T=s("el-switch"),U=s("el-form"),z=s("el-button"),D=s("el-dialog");return g(),j(D,{modelValue:c.value,"onUpdate:modelValue":l[5]||(l[5]=m=>c.value=m),title:"设置",width:"600px","before-close":o},{footer:t(()=>[e(z,{onClick:p},{default:t(()=>[...l[13]||(l[13]=[_("恢复默认",-1)])]),_:1}),e(z,{type:"primary",onClick:o},{default:t(()=>[...l[14]||(l[14]=[_("确定",-1)])]),_:1})]),default:t(()=>[e(U,{"label-width":"120px"},{default:t(()=>[e(v,{label:"主题模式"},{default:t(()=>[e(C,{modelValue:u.theme,"onUpdate:modelValue":l[0]||(l[0]=m=>u.theme=m),onChange:w},{default:t(()=>[e(f,{value:"light"},{default:t(()=>[e(d,null,{default:t(()=>[e(a(J))]),_:1}),l[6]||(l[6]=_(" 亮色 ",-1))]),_:1}),e(f,{value:"dark"},{default:t(()=>[e(d,null,{default:t(()=>[e(a(K))]),_:1}),l[7]||(l[7]=_(" 暗色 ",-1))]),_:1}),e(f,{value:"blue"},{default:t(()=>[e(d,null,{default:t(()=>[e(a(O))]),_:1}),l[8]||(l[8]=_(" 护眼蓝 ",-1))]),_:1}),e(f,{value:"auto"},{default:t(()=>[e(d,null,{default:t(()=>[e(a(Q))]),_:1}),l[9]||(l[9]=_(" 跟随系统 ",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"笔记列表布局"},{default:t(()=>[e(C,{modelValue:u.listLayout,"onUpdate:modelValue":l[1]||(l[1]=m=>u.listLayout=m),onChange:L},{default:t(()=>[e(f,{value:"grid"},{default:t(()=>[e(d,null,{default:t(()=>[e(a(W))]),_:1}),l[10]||(l[10]=_(" 网格 ",-1))]),_:1}),e(f,{value:"list"},{default:t(()=>[e(d,null,{default:t(()=>[e(a(q))]),_:1}),l[11]||(l[11]=_(" 列表 ",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"每页显示"},{default:t(()=>[e(I,{modelValue:u.pageSize,"onUpdate:modelValue":l[2]||(l[2]=m=>u.pageSize=m),onChange:B,style:{width:"150px"}},{default:t(()=>[e(r,{value:10,label:"10 条"}),e(r,{value:20,label:"20 条"}),e(r,{value:50,label:"50 条"}),e(r,{value:100,label:"100 条"})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"自动保存"},{default:t(()=>[e(T,{modelValue:u.autoSave,"onUpdate:modelValue":l[3]||(l[3]=m=>u.autoSave=m),onChange:F},null,8,["modelValue"]),l[12]||(l[12]=i("div",{class:"form-tip"},"编辑笔记时自动保存草稿",-1))]),_:1}),e(v,{label:"编辑器字体"},{default:t(()=>[e(I,{modelValue:u.editorFontSize,"onUpdate:modelValue":l[4]||(l[4]=m=>u.editorFontSize=m),onChange:M,style:{width:"150px"}},{default:t(()=>[e(r,{value:12,label:"小 (12px)"}),e(r,{value:14,label:"中 (14px)"}),e(r,{value:16,label:"大 (16px)"}),e(r,{value:18,label:"超大 (18px)"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},be=G(ye,[["__scopeId","data-v-bab5102e"]]),he={class:"main-layout"},Ve={class:"header-right fade-in-up-delay-1"},we={class:"user-info hover-lift active-scale"},xe={class:"username"},ke={class:"category-section"},Ce={class:"section-header"},Ie={key:0,class:"loading-text"},ze={key:1,class:"category-list"},Le=["onClick"],Be={key:2,class:"empty-text"},Fe={__name:"MainLayout",setup(E){const y=ee(),x=Y(),b=ve(),c=Se(),u=X(()=>x.path),w=$(!1);Z(()=>{c.fetchCategoryList()});const k=p=>{y.push(p)},L=p=>{switch(p){case"profile":y.push("/profile");break;case"settings":w.value=!0;break;case"logout":B();break}},B=()=>{R.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{b.logout(),y.push("/login")}).catch(()=>{})},F=()=>{R.prompt("请输入分类名称","新建分类",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S+/,inputErrorMessage:"分类名称不能为空"}).then(({value:p})=>{c.createCategory({name:p})}).catch(()=>{})},M=p=>{y.push(`/notes?categoryId=${p}`)};return(p,o)=>{const n=s("el-avatar"),l=s("el-icon"),d=s("el-dropdown-item"),f=s("el-dropdown-menu"),C=s("el-dropdown"),v=s("el-header"),r=s("el-menu-item"),I=s("el-menu"),T=s("el-button"),U=s("el-aside"),z=s("router-view"),D=s("el-main"),m=s("el-container");return g(),V("div",he,[e(v,{class:"main-header glass-navbar"},{default:t(()=>[o[4]||(o[4]=i("div",{class:"header-left fade-in-up"},[i("img",{src:fe,alt:"CloudNote",class:"header-logo"}),i("span",{class:"logo-text"},"云笔记")],-1)),i("div",Ve,[e(C,{onCommand:L},{dropdown:t(()=>[e(f,{class:"glass-card"},{default:t(()=>[e(d,{command:"profile"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(oe))]),_:1}),o[1]||(o[1]=_(" 个人信息 ",-1))]),_:1}),e(d,{command:"settings"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(ae))]),_:1}),o[2]||(o[2]=_(" 设置 ",-1))]),_:1}),e(d,{divided:"",command:"logout"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(se))]),_:1}),o[3]||(o[3]=_(" 退出登录 ",-1))]),_:1})]),_:1})]),default:t(()=>[i("div",we,[e(n,{size:36,src:a(ge)(a(b).avatar),icon:a(b).avatar?void 0:a(te)},null,8,["src","icon"]),i("span",xe,A(a(b).username),1),e(l,null,{default:t(()=>[e(a(le))]),_:1})])]),_:1})])]),_:1}),e(be,{modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=S=>w.value=S)},null,8,["modelValue"]),e(m,{class:"main-container"},{default:t(()=>[e(U,{width:"240px",class:"main-aside glass-sidebar custom-scrollbar smooth-scroll"},{default:t(()=>[e(I,{"default-active":u.value,class:"aside-menu",onSelect:k},{default:t(()=>[e(r,{index:"/notes",class:"fade-in-up"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(ne))]),_:1}),o[5]||(o[5]=i("span",null,"我的笔记",-1))]),_:1}),e(r,{index:"/categories",class:"fade-in-up-delay-1"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(P))]),_:1}),o[6]||(o[6]=i("span",null,"分类管理",-1))]),_:1}),e(r,{index:"/tags",class:"fade-in-up-delay-2"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(ue))]),_:1}),o[7]||(o[7]=i("span",null,"标签管理",-1))]),_:1}),e(r,{index:"/search",class:"fade-in-up-delay-3"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(de))]),_:1}),o[8]||(o[8]=i("span",null,"搜索笔记",-1))]),_:1}),e(r,{index:"/notes/trash",class:"fade-in-up-delay-3"},{default:t(()=>[e(l,null,{default:t(()=>[e(a(ie))]),_:1}),o[9]||(o[9]=i("span",null,"回收站",-1))]),_:1})]),_:1},8,["default-active"]),i("div",ke,[i("div",Ce,[o[10]||(o[10]=i("span",null,"分类",-1)),e(T,{icon:a(re),circle:"",size:"small",onClick:F},null,8,["icon"])]),a(c).loading?(g(),V("div",Ie," 加载中... ")):a(c).hasCategories?(g(),V("div",ze,[(g(!0),V(me,null,ce(a(c).categoryList,S=>(g(),V("div",{key:S.categoryId,class:"category-item",onClick:Me=>M(S.categoryId)},[e(l,null,{default:t(()=>[e(a(P))]),_:1}),i("span",null,A(S.name),1)],8,Le))),128))])):(g(),V("div",Be," 暂无分类 "))])]),_:1}),e(D,{class:"main-content custom-scrollbar smooth-scroll"},{default:t(()=>[e(z,null,{default:t(({Component:S})=>[e(_e,{name:"fade",mode:"out-in"},{default:t(()=>[(g(),j(pe(S)))]),_:2},1024)]),_:1})]),_:1})]),_:1})])}}},$e=G(Fe,[["__scopeId","data-v-0af24693"]]);export{$e as default};
