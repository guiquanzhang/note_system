import{y as r,c as o,o as s,a as n,b as l,w as c,r as i,u as I,A as K,d as M,f as x,s as C,Y as f,t as d,F as T,e as A,k as E,K as N,a0 as F}from"./index-CxuP8R5R.js";import{s as H}from"./note-CSOVseSf.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-CqNpOxbT.js";const P={class:"search-page"},U={class:"search-box"},$={key:0,class:"search-result"},j={class:"result-header"},R={key:0},q={key:1},G={key:0,class:"note-list"},J={class:"note-title"},O={class:"note-content"},Q={class:"note-meta"},W={key:0,class:"note-tags"},X={key:1,class:"pagination"},Z={key:1,class:"search-tip"},ee={__name:"Search",setup(te){const S=I(),p=r(""),_=r([]),u=r(0),v=r(1),g=r(10),m=r(!1),y=r(!1),h=async()=>{if(!p.value.trim()){N.warning("请输入搜索关键词");return}m.value=!0,y.value=!0;try{const t=await H({keyword:p.value.trim(),pageNum:v.value,pageSize:g.value});_.value=t.records||[],u.value=t.total||0}catch{N.error("搜索失败")}finally{m.value=!1}},V=t=>{S.push(`/notes/${t}/edit`)},b=t=>{if(!t)return"无内容";const e=t.replace(/<[^>]+>/g,"");return e.length>100?e.substring(0,100)+"...":e},z=t=>t?F(t).format("YYYY-MM-DD HH:mm"):"-";return(t,e)=>{const k=i("el-icon"),Y=i("el-button"),B=i("el-input"),w=i("el-card"),D=i("el-pagination");return s(),o("div",P,[e[4]||(e[4]=n("div",{class:"page-header"},[n("h2",null,"搜索笔记")],-1)),l(w,{class:"search-card"},{default:c(()=>[n("div",U,[l(B,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),placeholder:"输入关键词搜索笔记标题或内容",size:"large",clearable:"",onKeyup:K(h,["enter"])},{prefix:c(()=>[l(k,null,{default:c(()=>[l(x(C))]),_:1})]),append:c(()=>[l(Y,{type:"primary",onClick:h,loading:m.value},{default:c(()=>[...e[2]||(e[2]=[M(" 搜索 ",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),y.value?(s(),o("div",$,[n("div",j,[u.value>0?(s(),o("span",R,"找到 "+d(u.value)+" 条相关笔记",1)):(s(),o("span",q,"未找到相关笔记"))]),_.value.length>0?(s(),o("div",G,[(s(!0),o(T,null,A(_.value,a=>(s(),E(w,{key:a.noteId,class:"note-card",shadow:"hover",onClick:ae=>V(a.noteId)},{default:c(()=>[n("div",J,d(a.title||"无标题"),1),n("div",O,d(b(a.content)),1),n("div",Q,[n("span",null,d(z(a.updatedAt)),1),a.tags?(s(),o("span",W,d(a.tags),1)):f("",!0)])]),_:2},1032,["onClick"]))),128))])):f("",!0),u.value>g.value?(s(),o("div",X,[l(D,{"current-page":v.value,"onUpdate:currentPage":e[1]||(e[1]=a=>v.value=a),"page-size":g.value,total:u.value,layout:"prev, pager, next",onCurrentChange:h},null,8,["current-page","page-size","total"])])):f("",!0)])):(s(),o("div",Z,[l(k,{size:48,color:"#909399"},{default:c(()=>[l(x(C))]),_:1}),e[3]||(e[3]=n("p",null,"输入关键词搜索笔记",-1))]))]),_:1})])}}},re=L(ee,[["__scopeId","data-v-a1205a9f"]]);export{re as default};
